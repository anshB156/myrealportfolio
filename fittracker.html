<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FitTracker - All-in-One Fitness Platform</title>
    <style>
        /* CSS Variables for theming */
        :root {
            --primary-color: #007bff;
            --secondary-color: #6c757d;
            --background-color: #f4f7f6;
            --surface-color: #ffffff;
            --text-color: #333;
            --border-color: #dee2e6;
            --danger-color: #dc3545;
            --success-color: #28a745;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        /* Basic Reset and Typography */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
        }

        h1, h2, h3, h4 {
            line-height: 1.2;
            margin-bottom: 1rem;
        }

        /* Utility Classes */
        .hidden {
            display: none !important;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem 2rem;
        }

        .card {
            background: var(--surface-color);
            border-radius: 8px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
            margin-bottom: 1.5rem;
        }

        /* Button Styles */
        .btn {
            display: inline-block;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            text-align: center;
            transition: background-color 0.3s ease, transform 0.1s ease;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: #fff;
        }

        .btn-primary:hover {
            background-color: #0056b3;
        }

        .btn-secondary {
            background-color: var(--secondary-color);
            color: #fff;
        }
        
        .btn-success {
            background-color: var(--success-color);
            color: #fff;
        }

        .btn:active {
            transform: scale(0.98);
        }
        
        .btn-block {
            display: block;
            width: 100%;
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: bold;
        }

        .form-control {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            font-size: 1rem;
        }

        /* Authentication Page Layout */
        .auth-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .auth-form {
            width: 100%;
            max-width: 400px;
            padding: 2rem;
            background: var(--surface-color);
            border-radius: 8px;
            box-shadow: var(--shadow);
        }

        .auth-form h1 {
            text-align: center;
        }
        
        .auth-link {
            text-align: center;
            margin-top: 1rem;
        }
        
        .auth-link a {
            color: var(--primary-color);
            cursor: pointer;
            text-decoration: none;
        }
        
        .auth-link a:hover {
            text-decoration: underline;
        }
        
        .error-message {
            color: var(--danger-color);
            text-align: center;
            margin-bottom: 1rem;
        }

        /* Main App Layout */
        #app-page header {
            background-color: var(--primary-color);
            color: white;
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow);
        }

        #app-page header h1 {
            margin: 0;
            font-size: 1.5rem;
        }

        #app-page nav {
            background-color: var(--surface-color);
            padding: 0.5rem 0;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        #app-page nav ul {
            display: flex;
            justify-content: center;
            list-style: none;
        }

        #app-page nav a {
            display: block;
            padding: 10px 20px;
            text-decoration: none;
            color: var(--text-color);
            font-weight: bold;
            border-bottom: 3px solid transparent;
            transition: border-color 0.3s ease;
        }

        #app-page nav a.active,
        #app-page nav a:hover {
            border-bottom-color: var(--primary-color);
        }

        /* Dashboard Section */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
        }
        
        .stat-card {
            text-align: center;
            padding: 1.5rem;
        }
        
        .stat-card .value {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--primary-color);
        }
        
        .stat-card .label {
            font-weight: bold;
            color: var(--secondary-color);
        }

        /* Progress Section */
        #progress-chart {
            width: 100%;
            height: 300px;
            background: #f9f9f9;
            border: 1px solid var(--border-color);
            border-radius: 5px;
        }

        /* Workout Section */
        .workout-plan {
            border-left: 5px solid var(--primary-color);
            padding-left: 1rem;
        }
        
        .exercise {
            margin-left: 1.5rem;
            padding: 0.5rem;
            border-bottom: 1px solid #eee;
        }
        
        .exercise:last-child {
            border-bottom: none;
        }
        
        /* Social Section */
        .friend-list, .activity-feed {
            list-style: none;
        }
        
        .friend-list li, .activity-feed li {
            padding: 0.75rem;
            border-bottom: 1px solid var(--border-color);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            #app-page header {
                flex-direction: column;
                text-align: center;
            }
            
            #app-page header .user-info {
                margin-top: 0.5rem;
            }

            #app-page nav ul {
                flex-wrap: wrap;
            }

            #app-page nav a {
                padding: 10px 15px;
            }
        }
    </style>
</head>
<body>

    <div id="login-page">
        <div class="auth-container">
            <div class="auth-form">
                <h1>FitTracker Login</h1>
                <div id="login-error" class="error-message hidden"></div>
                <form id="login-form">
                    <div class="form-group">
                        <label for="login-username">Username</label>
                        <input type="text" id="login-username" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="login-password">Password</label>
                        <input type="password" id="login-password" class="form-control" required>
                    </div>
                    <button type="submit" class="btn btn-primary btn-block">Login</button>
                </form>
                <div class="auth-link">
                    <p>Don't have an account? <a id="show-register">Register here</a></p>
                </div>
            </div>
        </div>
    </div>

    <div id="register-page" class="hidden">
        <div class="auth-container">
            <div class="auth-form">
                <h1>Create Account</h1>
                <div id="register-error" class="error-message hidden"></div>
                <form id="register-form">
                    <div class="form-group">
                        <label for="register-username">Username</label>
                        <input type="text" id="register-username" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="register-email">Email</label>
                        <input type="email" id="register-email" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="register-password">Password</label>
                        <input type="password" id="register-password" class="form-control" required>
                    </div>
                    <button type="submit" class="btn btn-primary btn-block">Register</button>
                </form>
                <div class="auth-link">
                    <p>Already have an account? <a id="show-login">Login here</a></p>
                </div>
            </div>
        </div>
    </div>

    <div id="app-page" class="hidden">
        <header>
            <h1>FitTracker</h1>
            <div class="user-info">
                <span id="user-greeting"></span> | <span id="current-date"></span>
                <button id="logout-btn" class="btn btn-secondary" style="margin-left: 1rem;">Logout</button>
            </div>
        </header>
        <nav>
            <div class="container">
                <ul>
                    <li><a href="#dashboard" class="nav-link active">Dashboard</a></li>
                    <li><a href="#workouts" class="nav-link">Workouts</a></li>
                    <li><a href="#progress" class="nav-link">Progress</a></li>
                    <li><a href="#social" class="nav-link">Social</a></li>
                </ul>
            </div>
        </nav>
        <main class="container">
            <section id="dashboard-section" class="app-section">
                <h2>Dashboard</h2>
                <div class="card">
                    <h3>Today's Activity</h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="value">8,450</div>
                            <div class="label">Steps</div>
                        </div>
                        <div class="stat-card">
                            <div class="value">310</div>
                            <div class="label">Calories Burned</div>
                        </div>
                        <div class="stat-card">
                            <div class="value">45</div>
                            <div class="label">Active Minutes</div>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <h3>Wearable Device</h3>
                    <p>Status: <span id="wearable-status" style="font-weight:bold; color: var(--danger-color)">Disconnected</span></p>
                    <button id="connect-device-btn" class="btn btn-primary">Connect Device</button>
                    <button id="sync-data-btn" class="btn btn-secondary" disabled>Sync Data</button>
                </div>
                 <div class="card">
                    <h3>AI Recommendations</h3>
                    <ul>
                        <li>Based on your recent activity, consider a 20-minute walk to reach your daily step goal.</li>
                        <li>Your workout consistency is great! Try increasing the weight on your bench press next session.</li>
                        <li>For better recovery, aim for at least 7 hours of sleep tonight.</li>
                    </ul>
                </div>
            </section>

            <section id="workouts-section" class="app-section hidden">
                <h2>Workout Plans</h2>
                <div class="card">
                    <h3>Create New Workout Plan</h3>
                    <form id="new-plan-form">
                        <div class="form-group">
                            <label for="plan-name">Plan Name</label>
                            <input type="text" id="plan-name" class="form-control" required>
                        </div>
                         <div class="form-group">
                            <label for="plan-desc">Description</label>
                            <input type="text" id="plan-desc" class="form-control">
                        </div>
                        <button type="submit" class="btn btn-primary">Create Plan</button>
                    </form>
                </div>
                <div class="card">
                    <h3>My Workout Plans</h3>
                    <div id="workout-plans-container">
                        <p>No workout plans created yet.</p>
                    </div>
                </div>
                <div class="card">
                    <h3>Sample Templates</h3>
                    <p>Full Body Strength, Cardio Blast, Yoga Flow (Templates are for display)</p>
                </div>
            </section>

            <section id="progress-section" class="app-section hidden">
                <h2>Progress Monitoring</h2>
                 <div class="card">
                    <h3>Log Daily Metrics</h3>
                    <form id="log-progress-form">
                        <div class="form-group">
                            <label for="log-weight">Weight (kg)</label>
                            <input type="number" step="0.1" id="log-weight" class="form-control" required>
                        </div>
                         <div class="form-group">
                            <label for="log-bodyfat">Body Fat (%)</label>
                            <input type="number" step="0.1" id="log-bodyfat" class="form-control">
                        </div>
                         <div class="form-group">
                            <label for="log-notes">Notes</label>
                            <textarea id="log-notes" class="form-control"></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">Log Progress</button>
                    </form>
                </div>
                <div class="card">
                    <h3>Weight Trend</h3>
                    <svg id="progress-chart"></svg>
                </div>
                <div class="card">
                    <h3>Historical Data</h3>
                    <div id="historical-data-container">
                        <p>No data logged yet.</p>
                    </div>
                </div>
            </section>

            <section id="social-section" class="app-section hidden">
                <h2>Social Hub</h2>
                <div class="card">
                    <h3>Friends List</h3>
                    <ul class="friend-list">
                        <li>Alice Johnson</li>
                        <li>Bob Williams</li>
                        <li>Charlie Brown</li>
                    </ul>
                </div>
                 <div class="card">
                    <h3>Activity Feed</h3>
                    <ul class="activity-feed">
                        <li>Alice Johnson just completed a 5k run.</li>
                        <li>Bob Williams logged a new PR in Bench Press.</li>
                        <li>Charlie Brown completed the 'Full Body Strength' workout.</li>
                    </ul>
                </div>
                <div class="card">
                    <h3>Share Your Progress</h3>
                    <p>Share a summary of your latest achievements with your friends!</p>
                    <button id="share-progress-btn" class="btn btn-primary">Generate Shareable Summary</button>
                </div>
            </section>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- STATE MANAGEMENT ---
            const state = {
                currentUser: null,
                currentPage: 'login', // 'login', 'register', 'app'
                currentSection: 'dashboard', // 'dashboard', 'workouts', etc.
                users: {
                    // Dummy user for easy login
                    "testuser": {
                        username: "testuser",
                        email: "test@example.com",
                        password: "password",
                        workoutPlans: [],
                        progressLogs: [],
                    }
                }
            };

            // --- DOM ELEMENT SELECTORS ---
            const pages = {
                login: document.getElementById('login-page'),
                register: document.getElementById('register-page'),
                app: document.getElementById('app-page')
            };
            const sections = {
                dashboard: document.getElementById('dashboard-section'),
                workouts: document.getElementById('workouts-section'),
                progress: document.getElementById('progress-section'),
                social: document.getElementById('social-section'),
            };
            const navLinks = document.querySelectorAll('.nav-link');
            
            // --- RENDER/VIEW FUNCTIONS ---
            
            /**
             * Controls which main page is visible (login, register, or app)
             */
            function renderPage() {
                for (const pageName in pages) {
                    pages[pageName].classList.add('hidden');
                }
                pages[state.currentPage].classList.remove('hidden');
            }

            /**
             * Controls which section within the main app is visible
             */
            function renderSection() {
                for (const sectionName in sections) {
                    sections[sectionName].classList.add('hidden');
                }
                sections[state.currentSection].classList.remove('hidden');
                
                navLinks.forEach(link => {
                    link.classList.toggle('active', link.getAttribute('href') === `#${state.currentSection}`);
                });
            }

            /**
             * Initializes the main app view when a user logs in
             */
            function initializeApp() {
                document.getElementById('user-greeting').textContent = `Welcome, ${state.currentUser.username}`;
                document.getElementById('current-date').textContent = new Date().toLocaleDateString('en-GB');
                renderWorkoutPlans();
                renderProgress();
            }

            /**
             * Renders the user's workout plans
             */
            function renderWorkoutPlans() {
                const container = document.getElementById('workout-plans-container');
                const plans = state.currentUser.workoutPlans;

                if (plans.length === 0) {
                    container.innerHTML = '<p>No workout plans created yet.</p>';
                    return;
                }

                container.innerHTML = '';
                plans.forEach((plan, planIndex) => {
                    const planEl = document.createElement('div');
                    planEl.className = 'card workout-plan';
                    
                    let exercisesHTML = '';
                    if (plan.exercises.length > 0) {
                        exercisesHTML = plan.exercises.map(ex => `
                            <div class="exercise">
                                <strong>${ex.name}</strong> - ${ex.sets} sets, ${ex.reps} reps ${ex.weight ? `(${ex.weight} kg)` : ''}
                            </div>
                        `).join('');
                    } else {
                        exercisesHTML = '<p>No exercises added yet.</p>';
                    }

                    planEl.innerHTML = `
                        <h3>${plan.name} <button class="btn btn-danger" style="float:right; font-size: 0.8rem; padding: 5px 10px;" data-plan-index="${planIndex}">Delete</button></h3>
                        <p>${plan.description}</p>
                        <hr style="margin: 1rem 0;">
                        <h4>Exercises</h4>
                        ${exercisesHTML}
                        <hr style="margin: 1rem 0;">
                        <h4>Add Exercise</h4>
                        <form class="add-exercise-form" data-plan-index="${planIndex}">
                            <input type="text" name="name" placeholder="Exercise Name" required>
                            <input type="number" name="sets" placeholder="Sets" required>
                            <input type="number" name="reps" placeholder="Reps" required>
                            <input type="number" name="weight" placeholder="Weight (kg, optional)">
                            <button type="submit" class="btn btn-secondary">Add</button>
                        </form>
                    `;
                    container.appendChild(planEl);
                });
            }

            /**
             * Renders progress logs and the chart
             */
            function renderProgress() {
                const logs = state.currentUser.progressLogs;
                const container = document.getElementById('historical-data-container');
                
                if (logs.length === 0) {
                    container.innerHTML = '<p>No data logged yet.</p>';
                    document.getElementById('progress-chart').innerHTML = ''; // Clear chart
                    return;
                }
                
                // Render historical data list
                container.innerHTML = logs.map(log => `
                    <div class="card">
                        <strong>${new Date(log.date).toLocaleDateString('en-GB')}</strong> - 
                        Weight: ${log.weight} kg | 
                        Body Fat: ${log.bodyfat || 'N/A'}% <br>
                        <em>Notes: ${log.notes || 'None'}</em>
                    </div>
                `).join('');

                // Render SVG Chart
                renderWeightChart(logs);
            }
            
            /**
             * Renders an SVG line chart for weight progress
             * @param {Array} logs - Array of progress log objects
             */
            function renderWeightChart(logs) {
                const svg = document.getElementById('progress-chart');
                svg.innerHTML = ''; // Clear previous chart

                if (logs.length < 2) {
                    svg.innerHTML = '<text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle">Log at least 2 entries to see a trend</text>';
                    return;
                }

                const weights = logs.map(l => l.weight);
                const maxWeight = Math.max(...weights);
                const minWeight = Math.min(...weights);
                const padding = 40;
                const width = svg.clientWidth;
                const height = svg.clientHeight;
                const range = maxWeight - minWeight === 0 ? 1 : maxWeight - minWeight;

                // Function to map data points to SVG coordinates
                const getX = (index) => padding + (index / (logs.length - 1)) * (width - 2 * padding);
                const getY = (value) => height - padding - ((value - minWeight) / range) * (height - 2 * padding);
                
                // Create polyline for the graph
                const points = logs.map((log, i) => `${getX(i)},${getY(log.weight)}`).join(' ');
                const polyline = document.createElementNS('http://www.w3.org/2000/svg', 'polyline');
                polyline.setAttribute('points', points);
                polyline.setAttribute('fill', 'none');
                polyline.setAttribute('stroke', 'var(--primary-color)');
                polyline.setAttribute('stroke-width', '3');
                svg.appendChild(polyline);

                // Add circles for data points
                logs.forEach((log, i) => {
                    const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                    circle.setAttribute('cx', getX(i));
                    circle.setAttribute('cy', getY(log.weight));
                    circle.setAttribute('r', '5');
                    circle.setAttribute('fill', 'var(--primary-color)');
                    svg.appendChild(circle);
                });
                
                // Add Y-axis labels
                const yAxisMax = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                yAxisMax.setAttribute('x', padding - 10);
                yAxisMax.setAttribute('y', padding);
                yAxisMax.setAttribute('text-anchor', 'end');
                yAxisMax.textContent = `${maxWeight.toFixed(1)}kg`;
                svg.appendChild(yAxisMax);

                const yAxisMin = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                yAxisMin.setAttribute('x', padding - 10);
                yAxisMin.setAttribute('y', height - padding + 5);
                yAxisMin.setAttribute('text-anchor', 'end');
                yAxisMin.textContent = `${minWeight.toFixed(1)}kg`;
                svg.appendChild(yAxisMin);
            }

            // --- EVENT LISTENERS ---

            // Page Navigation (Login/Register)
            document.getElementById('show-register').addEventListener('click', () => {
                state.currentPage = 'register';
                renderPage();
            });
            document.getElementById('show-login').addEventListener('click', () => {
                state.currentPage = 'login';
                renderPage();
            });

            // Authentication Forms
            document.getElementById('login-form').addEventListener('submit', (e) => {
                e.preventDefault();
                const username = document.getElementById('login-username').value;
                const password = document.getElementById('login-password').value;
                const errorEl = document.getElementById('login-error');
                
                if (state.users[username] && state.users[username].password === password) {
                    state.currentUser = state.users[username];
                    state.currentPage = 'app';
                    errorEl.classList.add('hidden');
                    initializeApp();
                    renderPage();
                    renderSection();
                } else {
                    errorEl.textContent = 'Invalid username or password.';
                    errorEl.classList.remove('hidden');
                }
            });

            document.getElementById('register-form').addEventListener('submit', (e) => {
                e.preventDefault();
                const username = document.getElementById('register-username').value;
                const email = document.getElementById('register-email').value;
                const password = document.getElementById('register-password').value;
                const errorEl = document.getElementById('register-error');

                if (state.users[username]) {
                    errorEl.textContent = 'Username already exists.';
                    errorEl.classList.remove('hidden');
                } else {
                    state.users[username] = { username, email, password, workoutPlans: [], progressLogs: [] };
                    alert('Registration successful! Please log in.');
                    state.currentPage = 'login';
                    errorEl.classList.add('hidden');
                    renderPage();
                }
            });
            
            // Logout
            document.getElementById('logout-btn').addEventListener('click', () => {
                state.currentUser = null;
                state.currentPage = 'login';
                state.currentSection = 'dashboard';
                // Clear form fields on logout for better UX
                document.getElementById('login-form').reset();
                document.getElementById('register-form').reset();
                renderPage();
            });

            // Main App Navigation
            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    state.currentSection = e.target.getAttribute('href').substring(1);
                    renderSection();
                });
            });

            // Wearable Device Simulation
            document.getElementById('connect-device-btn').addEventListener('click', () => {
                document.getElementById('wearable-status').textContent = 'Connected';
                document.getElementById('wearable-status').style.color = 'var(--success-color)';
                document.getElementById('sync-data-btn').disabled = false;
            });
            document.getElementById('sync-data-btn').addEventListener('click', () => {
                alert('Data synced successfully from your wearable device (simulated).');
            });
            
            // Workout Plan Creation
            document.getElementById('new-plan-form').addEventListener('submit', e => {
                e.preventDefault();
                const name = document.getElementById('plan-name').value;
                const description = document.getElementById('plan-desc').value;
                
                state.currentUser.workoutPlans.push({ name, description, exercises: [] });
                renderWorkoutPlans();
                e.target.reset();
            });
            
            // Add/Delete Exercises/Plans (using event delegation)
            document.getElementById('workouts-section').addEventListener('submit', e => {
                if (e.target.classList.contains('add-exercise-form')) {
                    e.preventDefault();
                    const planIndex = e.target.dataset.planIndex;
                    const exercise = {
                        name: e.target.elements.name.value,
                        sets: e.target.elements.sets.value,
                        reps: e.target.elements.reps.value,
                        weight: e.target.elements.weight.value || null,
                    };
                    state.currentUser.workoutPlans[planIndex].exercises.push(exercise);
                    renderWorkoutPlans();
                }
            });
            
            document.getElementById('workouts-section').addEventListener('click', e => {
                 if (e.target.matches('button[data-plan-index]')) {
                    const planIndex = e.target.dataset.planIndex;
                    if (confirm('Are you sure you want to delete this workout plan?')) {
                        state.currentUser.workoutPlans.splice(planIndex, 1);
                        renderWorkoutPlans();
                    }
                 }
            });
            
            // Log Progress
            document.getElementById('log-progress-form').addEventListener('submit', e => {
                e.preventDefault();
                const log = {
                    date: new Date().toISOString(),
                    weight: parseFloat(document.getElementById('log-weight').value),
                    bodyfat: parseFloat(document.getElementById('log-bodyfat').value) || null,
                    notes: document.getElementById('log-notes').value,
                };
                state.currentUser.progressLogs.push(log);
                state.currentUser.progressLogs.sort((a,b) => new Date(a.date) - new Date(b.date)); // Keep logs sorted
                renderProgress();
                e.target.reset();
            });
            
            // Share Progress Button
            document.getElementById('share-progress-btn').addEventListener('click', () => {
                alert('Mock Share Summary:\n\nJust finished a great week at FitTracker! \n- Completed 3 workouts \n- Hit a new weight goal!\n\n#FitTracker #FitnessJourney');
            });


            renderPage();
        });
    </script>
</body>
</html>
